<!doctype html><html lang=en-us dir=ltr><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-QB4H991E1G"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QB4H991E1G")</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><meta name=keywords content="翻轉吧金魚腦,使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><title>使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行</title>
<link rel=canonical href=https://blog.goldfishbrain-fighting.com/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/><link rel=stylesheet href=/scss/style.min.7fb7f5621081d8ecec310edc2d95cc0b431358ce9c30c3ee8601b16732dbef57.css><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script>$(document).ready(function(){var e=setInterval(s,100),t=100,n=50;function s(){$("#busuanzi_container_site_pv").css("display")!="none"&&(clearInterval(e),$("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html())+t),$("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html())+n))}})</script><meta property="og:title" content="使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><meta property="og:description" content="使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><meta property="og:url" content="https://blog.goldfishbrain-fighting.com/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/"><meta property="og:site_name" content="翻轉吧金魚腦"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="redis"><meta property="article:tag" content="redisinsight"><meta property="article:tag" content="redis-cluster"><meta property="article:published_time" content="2023-12-17T17:05:34+08:00"><meta property="article:modified_time" content="2023-12-17T17:05:34+08:00"><meta name=twitter:title content="使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><meta name=twitter:description content="使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行"><link rel="shortcut icon" href=/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-QB4H991E1G"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QB4H991E1G")</script><meta name=google-site-verification content="EkUcMLTrO3RDZzjREX9Dffy2lcjWCR-2Qtu8VF4b8sQ"><meta content="翻轉吧金魚腦,使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行" name=keywords></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><div id=article-toolbar style=position:sticky;top:5px;z-index:1000><a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>返回</span></a></div><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目錄</h2><div class=widget--toc><nav id=TableOfContents><ul><li><ul><li><a href=#redis-cluster主機ip表>Redis Cluster主機IP表</a></li><li><a href=#redisinsight添加redis主機>RedisInsight添加Redis主機</a></li><li><a href=#使用bulk-action-restore數據>使用BULK ACTION Restore數據</a></li><li><a href=#分析數據>分析數據</a></li><li><a href=#測試數據是否正確結果-有些數據key-name被修改了>測試數據，是否正確，結果->有些數據Key Name被修改了</a></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/redis/ style=background-color:#d6332d;color:#fff>redis</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/>使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行</a></h2><h3 class=article-subtitle>使用RedisInsight 1.x版，BULK ACTIONS功能，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->有些數據Key Name被修改了，此方式不可行</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>2023/12/17</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>閱讀時間: 7 分鐘</time></div></footer></div></header><section class=article-content><section class="toc toc--inline"><h2>目錄</h2><div><nav id=TableOfContents><ul><li><ul><li><a href=#redis-cluster主機ip表>Redis Cluster主機IP表</a></li><li><a href=#redisinsight添加redis主機>RedisInsight添加Redis主機</a></li><li><a href=#使用bulk-action-restore數據>使用BULK ACTION Restore數據</a></li><li><a href=#分析數據>分析數據</a></li><li><a href=#測試數據是否正確結果-有些數據key-name被修改了>測試數據，是否正確，結果->有些數據Key Name被修改了</a></li></ul></li></ul></nav></div></section><h2 id=redis-cluster主機ip表>Redis Cluster主機IP表</h2><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217182757.png width=668 height=1011 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217182757_hu958cbfd0a734f396244b4db5ea229923_132015_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217182757_hu958cbfd0a734f396244b4db5ea229923_132015_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=66 data-flex-basis=158px></p><div class=table-wrapper><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>主機名稱</td><td>主機IP</td><td>角色</td><td>主機IP</td><td>角色</td><td>跟隨</td></tr><tr><td>redis91</td><td>192.168.1.91:6379</td><td>master</td><td>192.168.1.91:6380</td><td>slave</td><td>192.168.1.92:6380</td></tr><tr><td>redis92</td><td>192.168.1.92:6379</td><td>master</td><td>192.168.1.92:6380</td><td>slave</td><td>192.168.1.93:6380</td></tr><tr><td>redis93</td><td>192.168.1.93:6379</td><td>master</td><td>192.168.1.93:6380</td><td>slave</td><td>192.168.1.91:6380</td></tr><tr><td>redis94</td><td>192.168.1.94:6379</td><td>master</td><td>192.168.1.94:6380</td><td>slave</td><td>192.168.1.98:6380</td></tr><tr><td>redis98</td><td>192.168.1.98:6379</td><td>master</td><td>192.168.1.98:6380</td><td>slave</td><td>192.168.1.94:6380</td></tr></tbody></table></div><h2 id=redisinsight添加redis主機>RedisInsight添加Redis主機</h2><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170716.png width=1112 height=679 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170716_hu8941ff57d904a7570160d2b84b67f41c_52216_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170716_hu8941ff57d904a7570160d2b84b67f41c_52216_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=163 data-flex-basis=393px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170728.png width=1118 height=632 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170728_hu063dd0b54e9d99400b14cc8c918e0655_90309_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170728_hu063dd0b54e9d99400b14cc8c918e0655_90309_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=176 data-flex-basis=424px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170744.png width=1155 height=700 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170744_hu8099a67496bdb5dfde1d28b49eb4b9c4_63457_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170744_hu8099a67496bdb5dfde1d28b49eb4b9c4_63457_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=165 data-flex-basis=396px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173105.png width=1679 height=775 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173105_hu0e7edbdab7fde8c2c7e2dba7a6e95699_116971_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173105_hu0e7edbdab7fde8c2c7e2dba7a6e95699_116971_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=216 data-flex-basis=519px></p><h2 id=使用bulk-action-restore數據>使用BULK ACTION Restore數據</h2><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170841.png width=1118 height=774 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170841_hu55eae7e8d5f6eee98578b69c9738d807_100007_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217170841_hu55eae7e8d5f6eee98578b69c9738d807_100007_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=144 data-flex-basis=346px></p><p>我是用k8s佈屬RedisInsight，所以才看一下，佈屬到哪個節點，需要把要恢復數據的RBD檔案，傳至那台主機RedisInsight POD裡面</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@k8s-master71u:~# kubectl get pod -o wide
</span></span><span class=line><span class=cl>NAME                           READY   STATUS    RESTARTS      AGE   IP               NODE          NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>redisinsight-cf7f6847b-s2zgg   1/1     Running   <span class=m>0</span>             18h   10.201.255.218   k8s-node76u   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>test-nginx                     1/1     Running   <span class=m>2</span> <span class=o>(</span>13d ago<span class=o>)</span>   13d   10.201.14.154    k8s-node75u   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>web2-5d48fb75c5-dt5xd          1/1     Running   <span class=m>2</span> <span class=o>(</span>13d ago<span class=o>)</span>   13d   10.201.255.211   k8s-node76u   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>web2-5d48fb75c5-ggmrz          1/1     Running   <span class=m>2</span> <span class=o>(</span>13d ago<span class=o>)</span>   13d   10.201.14.148    k8s-node75u   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>web2-5d48fb75c5-jsvck          1/1     Running   <span class=m>2</span> <span class=o>(</span>13d ago<span class=o>)</span>   13d   10.201.255.215   k8s-node76u   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@k8s-node76u:~# docker ps <span class=p>|</span> grep -i redis
</span></span><span class=line><span class=cl>5524bf7385e4   64a3d4d7e868                <span class=s2>&#34;bash ./docker-entry…&#34;</span>   <span class=m>18</span> hours ago   Up <span class=m>18</span> hours             k8s_redisinsight_redisinsight-cf7f6847b-s2zgg_default_65440569-c6e2-4f40-b836-8bf2b0c9b511_0
</span></span><span class=line><span class=cl>efebd005bac3   registry.k8s.io/pause:3.9   <span class=s2>&#34;/pause&#34;</span>                 <span class=m>18</span> hours ago   Up <span class=m>18</span> hours             k8s_POD_redisinsight-cf7f6847b-s2zgg_default_65440569-c6e2-4f40-b836-8bf2b0c9b511_0
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@k8s-node76u:~# docker <span class=nb>exec</span> -ti 5524bf7385e4 bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/app$ ls -l
</span></span><span class=line><span class=cl>total <span class=m>64</span>
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root  <span class=m>6015</span> May  <span class=m>2</span>  <span class=m>2023</span> appicon.pyc
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root   <span class=m>841</span> May  <span class=m>2</span>  <span class=m>2023</span> docker-entry.sh
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root   <span class=m>377</span> May  <span class=m>2</span>  <span class=m>2023</span> entry.pyc
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root  <span class=m>2511</span> May  <span class=m>2</span>  <span class=m>2023</span> manage.pyc
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root  <span class=m>6850</span> May  <span class=m>2</span>  <span class=m>2023</span> pyinstaller.spec
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>24</span> root root  <span class=m>4096</span> May  <span class=m>2</span>  <span class=m>2023</span> redisinsight
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root  <span class=m>1089</span> May  <span class=m>2</span>  <span class=m>2023</span> requirements.txt
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root <span class=m>26991</span> May  <span class=m>2</span>  <span class=m>2023</span> startup.pyc
</span></span><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/app$
</span></span></code></pre></div><p>將要恢復數據的RBD檔案，傳至RedisInsight POD裡面</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@k8s-node76u:~# chown -R root:root dump-master*.rdb
</span></span><span class=line><span class=cl>root@k8s-node76u:~# chmod o+rw dump-master*.rdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@k8s-node76u:~# docker cp dump-master1.rdb 5524bf7385e4:/app/dump-master1.rdb
</span></span><span class=line><span class=cl>root@k8s-node76u:~# docker cp dump-master2.rdb 5524bf7385e4:/app/dump-master2.rdb
</span></span><span class=line><span class=cl>root@k8s-node76u:~# docker cp dump-master3.rdb 5524bf7385e4:/app/dump-master3.rdb
</span></span><span class=line><span class=cl>root@k8s-node76u:~# docker cp dump-master4.rdb 5524bf7385e4:/app/dump-master4.rdb
</span></span><span class=line><span class=cl>root@k8s-node76u:~# docker cp dump-master5.rdb 5524bf7385e4:/app/dump-master5.rdb
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/app$ ls -l
</span></span><span class=line><span class=cl>total <span class=m>1758796</span>
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root      <span class=m>6015</span> May  <span class=m>2</span>  <span class=m>2023</span> appicon.pyc
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root       <span class=m>841</span> May  <span class=m>2</span>  <span class=m>2023</span> docker-entry.sh
</span></span><span class=line><span class=cl>-rw----rw-  <span class=m>1</span> root root <span class=m>343630318</span> Dec  <span class=m>5</span> 07:27 dump-master1.rdb
</span></span><span class=line><span class=cl>-rw----rw-  <span class=m>1</span> root root <span class=m>348759548</span> Dec  <span class=m>5</span> 07:32 dump-master2.rdb
</span></span><span class=line><span class=cl>-rw----rw-  <span class=m>1</span> root root <span class=m>349938872</span> Dec  <span class=m>5</span> 07:53 dump-master3.rdb
</span></span><span class=line><span class=cl>-rw----rw-  <span class=m>1</span> root root <span class=m>402484559</span> Dec  <span class=m>5</span> 07:56 dump-master4.rdb
</span></span><span class=line><span class=cl>-rw----rw-  <span class=m>1</span> root root <span class=m>356118026</span> Dec  <span class=m>5</span> 07:56 dump-master5.rdb
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root       <span class=m>377</span> May  <span class=m>2</span>  <span class=m>2023</span> entry.pyc
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root      <span class=m>2511</span> May  <span class=m>2</span>  <span class=m>2023</span> manage.pyc
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root      <span class=m>6850</span> May  <span class=m>2</span>  <span class=m>2023</span> pyinstaller.spec
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>24</span> root root      <span class=m>4096</span> May  <span class=m>2</span>  <span class=m>2023</span> redisinsight
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> root root      <span class=m>1089</span> May  <span class=m>2</span>  <span class=m>2023</span> requirements.txt
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root     <span class=m>26991</span> May  <span class=m>2</span>  <span class=m>2023</span> startup.pyc
</span></span></code></pre></div><p>開始恢復數據
<img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173157.png width=1124 height=774 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173157_hu24a702ba6f3fc8c7d4b878270ed652e5_107549_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173157_hu24a702ba6f3fc8c7d4b878270ed652e5_107549_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=145 data-flex-basis=348px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173216.png width=1716 height=787 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173216_hud738e7dae71b3ecce62c0ff15ac06370_115574_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173216_hud738e7dae71b3ecce62c0ff15ac06370_115574_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=218 data-flex-basis=523px></p><p>恢復數據完成
<img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173438.png width=1714 height=789 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173438_hu934af6320153a37e888616a64c623532_113353_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173438_hu934af6320153a37e888616a64c623532_113353_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=217 data-flex-basis=521px></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis91 redis<span class=o>]</span><span class=c1># redis-cli --user 帳號 --pass 密碼 --cluster check 192.168.1.91:6379</span>
</span></span><span class=line><span class=cl>Warning: Using a password with <span class=s1>&#39;-a&#39;</span> or <span class=s1>&#39;-u&#39;</span> option on the <span class=nb>command</span> line interface may not be safe.
</span></span><span class=line><span class=cl>192.168.1.91:6379 <span class=o>(</span>2c05c930...<span class=o>)</span> -&gt; <span class=m>122790</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.98:6379 <span class=o>(</span>c40f72b0...<span class=o>)</span> -&gt; <span class=m>75980</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.92:6379 <span class=o>(</span>71d88e30...<span class=o>)</span> -&gt; <span class=m>91349</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.93:6379 <span class=o>(</span>caa1fb6b...<span class=o>)</span> -&gt; <span class=m>76507</span> keys <span class=p>|</span> <span class=m>3276</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.94:6379 <span class=o>(</span>eaeb50d0...<span class=o>)</span> -&gt; <span class=m>76336</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> <span class=m>442962</span> keys in <span class=m>5</span> masters.
</span></span><span class=line><span class=cl>27.04 keys per slot on average.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Performing Cluster Check <span class=o>(</span>using node 192.168.1.91:6379<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 2c05c930c506e54ebea35f8f0b731754cd44082a 192.168.1.91:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>0-3276<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 1709189e2036c2e0c4168189be9074d66bce2991 192.168.1.92:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 2c05c930c506e54ebea35f8f0b731754cd44082a
</span></span><span class=line><span class=cl>M: c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf 192.168.1.98:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>13107-16383<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 71d88e302c0a7ec240cbbb6f8380786d01da984c 192.168.1.92:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>3277-6553<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: caa1fb6b5fbc4e133b5ef472e2def11e836481f7 192.168.1.93:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>6554-9829<span class=o>]</span> <span class=o>(</span><span class=m>3276</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 500ed38b799c6d5ad13483f8e0fee45fc9142d69 192.168.1.94:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf
</span></span><span class=line><span class=cl>S: 533669750790e904050e917657beae942185a407 192.168.1.91:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates caa1fb6b5fbc4e133b5ef472e2def11e836481f7
</span></span><span class=line><span class=cl>S: b0bff6695a1318da9a01af2550c85de1e8e81a83 192.168.1.93:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 71d88e302c0a7ec240cbbb6f8380786d01da984c
</span></span><span class=line><span class=cl>M: eaeb50d0d31025f1589b7c8cdc12867f7a474c24 192.168.1.94:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>9830-13106<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 2b487243e0c78adb93ac73017d04a6ad39b51c36 192.168.1.98:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates eaeb50d0d31025f1589b7c8cdc12867f7a474c24
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All nodes agree about slots configuration.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check <span class=k>for</span> open slots...
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check slots coverage...
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All <span class=m>16384</span> slots covered.
</span></span></code></pre></div><p>再選第二個rbd檔進行恢復
<img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173551.png width=1711 height=767 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173551_hu09f9e6f01303187eae4fce88869a6eaa_128490_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173551_hu09f9e6f01303187eae4fce88869a6eaa_128490_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=223 data-flex-basis=535px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173646.png width=1718 height=844 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173646_huaf632375579d3507ea0ea82dc245424e_124377_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173646_huaf632375579d3507ea0ea82dc245424e_124377_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=203 data-flex-basis=488px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173937.png width=1714 height=790 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173937_hu2e766fa75da7d163520a39c4b5a93aae_119721_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217173937_hu2e766fa75da7d163520a39c4b5a93aae_119721_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=216 data-flex-basis=520px></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis91 redis<span class=o>]</span><span class=c1># redis-cli --user 帳號 --pass 密碼 --cluster check 192.168.1.91:6379</span>
</span></span><span class=line><span class=cl>Warning: Using a password with <span class=s1>&#39;-a&#39;</span> or <span class=s1>&#39;-u&#39;</span> option on the <span class=nb>command</span> line interface may not be safe.
</span></span><span class=line><span class=cl>192.168.1.91:6379 <span class=o>(</span>2c05c930...<span class=o>)</span> -&gt; <span class=m>198625</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.98:6379 <span class=o>(</span>c40f72b0...<span class=o>)</span> -&gt; <span class=m>152593</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.92:6379 <span class=o>(</span>71d88e30...<span class=o>)</span> -&gt; <span class=m>198771</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.93:6379 <span class=o>(</span>caa1fb6b...<span class=o>)</span> -&gt; <span class=m>184053</span> keys <span class=p>|</span> <span class=m>3276</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.94:6379 <span class=o>(</span>eaeb50d0...<span class=o>)</span> -&gt; <span class=m>152590</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> <span class=m>886632</span> keys in <span class=m>5</span> masters.
</span></span><span class=line><span class=cl>54.12 keys per slot on average.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Performing Cluster Check <span class=o>(</span>using node 192.168.1.91:6379<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 2c05c930c506e54ebea35f8f0b731754cd44082a 192.168.1.91:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>0-3276<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 1709189e2036c2e0c4168189be9074d66bce2991 192.168.1.92:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 2c05c930c506e54ebea35f8f0b731754cd44082a
</span></span><span class=line><span class=cl>M: c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf 192.168.1.98:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>13107-16383<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 71d88e302c0a7ec240cbbb6f8380786d01da984c 192.168.1.92:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>3277-6553<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: caa1fb6b5fbc4e133b5ef472e2def11e836481f7 192.168.1.93:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>6554-9829<span class=o>]</span> <span class=o>(</span><span class=m>3276</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 500ed38b799c6d5ad13483f8e0fee45fc9142d69 192.168.1.94:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf
</span></span><span class=line><span class=cl>S: 533669750790e904050e917657beae942185a407 192.168.1.91:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates caa1fb6b5fbc4e133b5ef472e2def11e836481f7
</span></span><span class=line><span class=cl>S: b0bff6695a1318da9a01af2550c85de1e8e81a83 192.168.1.93:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 71d88e302c0a7ec240cbbb6f8380786d01da984c
</span></span><span class=line><span class=cl>M: eaeb50d0d31025f1589b7c8cdc12867f7a474c24 192.168.1.94:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>9830-13106<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 2b487243e0c78adb93ac73017d04a6ad39b51c36 192.168.1.98:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates eaeb50d0d31025f1589b7c8cdc12867f7a474c24
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All nodes agree about slots configuration.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check <span class=k>for</span> open slots...
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check slots coverage...
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All <span class=m>16384</span> slots covered.
</span></span></code></pre></div><p>再選第三個rbd檔進行恢復，陸續將5個都恢復完成</p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174037.png width=1716 height=773 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174037_hu5f22c996f6384f509836bf44138693cf_134780_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174037_hu5f22c996f6384f509836bf44138693cf_134780_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=221 data-flex-basis=532px></p><p>陸續完成五個dump.rdb的RESTORE</p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174851.png width=1716 height=759 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174851_hu20fe9b2924c3d0f7d31686b02efd9333_136972_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217174851_hu20fe9b2924c3d0f7d31686b02efd9333_136972_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=226 data-flex-basis=542px></p><p>可以看到，key是平均寫入每個master，slot也不會有什麼改變</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis91 redis<span class=o>]</span><span class=c1># redis-cli --user 帳號 --pass 密碼 --cluster check 192.168.1.91:6379</span>
</span></span><span class=line><span class=cl>Warning: Using a password with <span class=s1>&#39;-a&#39;</span> or <span class=s1>&#39;-u&#39;</span> option on the <span class=nb>command</span> line interface may not be safe.
</span></span><span class=line><span class=cl>192.168.1.91:6379 <span class=o>(</span>2c05c930...<span class=o>)</span> -&gt; <span class=m>442550</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.98:6379 <span class=o>(</span>c40f72b0...<span class=o>)</span> -&gt; <span class=m>444646</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.92:6379 <span class=o>(</span>71d88e30...<span class=o>)</span> -&gt; <span class=m>443416</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.93:6379 <span class=o>(</span>caa1fb6b...<span class=o>)</span> -&gt; <span class=m>444081</span> keys <span class=p>|</span> <span class=m>3276</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl>192.168.1.94:6379 <span class=o>(</span>eaeb50d0...<span class=o>)</span> -&gt; <span class=m>443884</span> keys <span class=p>|</span> <span class=m>3277</span> slots <span class=p>|</span> <span class=m>1</span> slaves.
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> <span class=m>2218577</span> keys in <span class=m>5</span> masters.
</span></span><span class=line><span class=cl>135.41 keys per slot on average.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Performing Cluster Check <span class=o>(</span>using node 192.168.1.91:6379<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 2c05c930c506e54ebea35f8f0b731754cd44082a 192.168.1.91:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>0-3276<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 1709189e2036c2e0c4168189be9074d66bce2991 192.168.1.92:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 2c05c930c506e54ebea35f8f0b731754cd44082a
</span></span><span class=line><span class=cl>M: c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf 192.168.1.98:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>13107-16383<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: 71d88e302c0a7ec240cbbb6f8380786d01da984c 192.168.1.92:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>3277-6553<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>M: caa1fb6b5fbc4e133b5ef472e2def11e836481f7 192.168.1.93:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>6554-9829<span class=o>]</span> <span class=o>(</span><span class=m>3276</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 500ed38b799c6d5ad13483f8e0fee45fc9142d69 192.168.1.94:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates c40f72b0ee3ac4be0b9ddaea4d16079f723e13bf
</span></span><span class=line><span class=cl>S: 533669750790e904050e917657beae942185a407 192.168.1.91:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates caa1fb6b5fbc4e133b5ef472e2def11e836481f7
</span></span><span class=line><span class=cl>S: b0bff6695a1318da9a01af2550c85de1e8e81a83 192.168.1.93:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates 71d88e302c0a7ec240cbbb6f8380786d01da984c
</span></span><span class=line><span class=cl>M: eaeb50d0d31025f1589b7c8cdc12867f7a474c24 192.168.1.94:6379
</span></span><span class=line><span class=cl>   slots:<span class=o>[</span>9830-13106<span class=o>]</span> <span class=o>(</span><span class=m>3277</span> slots<span class=o>)</span> master
</span></span><span class=line><span class=cl>   <span class=m>1</span> additional replica<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>S: 2b487243e0c78adb93ac73017d04a6ad39b51c36 192.168.1.98:6380
</span></span><span class=line><span class=cl>   slots: <span class=o>(</span><span class=m>0</span> slots<span class=o>)</span> slave
</span></span><span class=line><span class=cl>   replicates eaeb50d0d31025f1589b7c8cdc12867f7a474c24
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All nodes agree about slots configuration.
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check <span class=k>for</span> open slots...
</span></span><span class=line><span class=cl>&gt;&gt;&gt; Check slots coverage...
</span></span><span class=line><span class=cl><span class=o>[</span>OK<span class=o>]</span> All <span class=m>16384</span> slots covered.
</span></span></code></pre></div><h2 id=分析數據>分析數據</h2><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175052.png width=1652 height=756 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175052_hu1e6f69fa541db1247a7b9997e31f2b7d_98815_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175052_hu1e6f69fa541db1247a7b9997e31f2b7d_98815_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=218 data-flex-basis=524px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175113.png width=1215 height=720 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175113_hu958f04d58f0c25c1ed4f6b09ce32f109_101955_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175113_hu958f04d58f0c25c1ed4f6b09ce32f109_101955_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=168 data-flex-basis=405px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175141.png width=707 height=549 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175141_hu521eac495c8b9ba0c2ed1b45668fe721_37116_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175141_hu521eac495c8b9ba0c2ed1b45668fe721_37116_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=128 data-flex-basis=309px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175157.png width=1679 height=913 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175157_huc2153e67b2b306265b0dd5015c4b6120_122574_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175157_huc2153e67b2b306265b0dd5015c4b6120_122574_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=183 data-flex-basis=441px></p><p>會讓REDIS執行一次bgsave，存下目前的所有key，並使用SYNC，將檔案複製到RedisInsight目錄/db/rsnaps裡面來進行分析</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis91 redis<span class=o>]</span><span class=c1># ll</span>
</span></span><span class=line><span class=cl>總計 <span class=m>595660</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis <span class=m>609714517</span> 12月 <span class=m>17</span> 17:53 dump6379.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis       <span class=m>175</span> 12月 <span class=m>17</span> 17:16 dump6380.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis      <span class=m>1303</span> 12月 <span class=m>16</span> 22:17 nodes-6379.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis      <span class=m>1303</span> 12月 <span class=m>16</span> 22:17 nodes-6380.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis    <span class=m>109501</span> 12月 <span class=m>16</span> 22:01 redis6380.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis    <span class=m>109501</span> 12月 <span class=m>16</span> 22:01 redis.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redis redis      <span class=m>1041</span> 12月 <span class=m>16</span> 22:01 users.acl
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/db/rsnaps$ <span class=nb>pwd</span>
</span></span><span class=line><span class=cl>/db/rsnaps
</span></span><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/db/rsnaps$ ls -lh
</span></span><span class=line><span class=cl>total 5.0G
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 975M Dec <span class=m>17</span> 09:56 2a974363-c6f6-4d86-9333-68a5d83f46a2.rsnap
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 647M Dec <span class=m>17</span> 09:52 2a974363-c6f6-4d86-9333-68a5d83f46a21702806698_0.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 568M Dec <span class=m>17</span> 09:52 2a974363-c6f6-4d86-9333-68a5d83f46a21702806733_1.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 579M Dec <span class=m>17</span> 09:53 2a974363-c6f6-4d86-9333-68a5d83f46a21702806764_2.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 582M Dec <span class=m>17</span> 09:53 2a974363-c6f6-4d86-9333-68a5d83f46a21702806794_3.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 583M Dec <span class=m>17</span> 09:54 2a974363-c6f6-4d86-9333-68a5d83f46a21702806827_4.rdb
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 819M Dec <span class=m>16</span> 15:10 f784974f-a2e9-4dec-a74c-2b309d733efe.rsnap
</span></span></code></pre></div><p>執行完畢後</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>redisinsight@redisinsight-cf7f6847b-s2zgg:/db/rsnaps$ ls -lh
</span></span><span class=line><span class=cl>total 1.8G
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 975M Dec <span class=m>17</span> 09:56 2a974363-c6f6-4d86-9333-68a5d83f46a2.rsnap
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> redisinsight redisinsight 819M Dec <span class=m>16</span> 15:10 f784974f-a2e9-4dec-a74c-2b309d733efe.rsnap
</span></span></code></pre></div><p>用RedisInsight BULK ACTIONS復原數據的效果</p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175808.png width=1664 height=878 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175808_huf5fd5049a9d41f530456b6c2b3e5a547_140279_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175808_huf5fd5049a9d41f530456b6c2b3e5a547_140279_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=189 data-flex-basis=454px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175855.png width=1681 height=913 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175855_hu025e17bfca9d8479fb79a7c3cbf5b100_262186_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217175855_hu025e17bfca9d8479fb79a7c3cbf5b100_262186_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=184 data-flex-basis=441px></p><p>以下是將RBD檔案複製到REDIS目錄，一台一台REDIS服務重啟，慢慢導入RBD數據的效果</p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180124.png width=1677 height=807 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180124_hu8fe506ee02ff998d1d1e8dc4d146a970_106504_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180124_hu8fe506ee02ff998d1d1e8dc4d146a970_106504_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=207 data-flex-basis=498px></p><p><img src=/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180139.png width=1676 height=909 srcset="/2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180139_hucd14407a271551d597e0c9776110b94b_261103_480x0_resize_box_3.png 480w, /2023/redis-cluster-database-transfer-with-redisinsight-bulk-actions/media/Pasted-image-20231217180139_hucd14407a271551d597e0c9776110b94b_261103_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=184 data-flex-basis=442px></p><p>看起來效果是一樣，但是使用RedisInsight BULK ACTIONS，有幾個好處：</p><ol><li>Redis服務不用重啟，線上恢復數據</li><li>Redis slot不會有異常分配狀況，還要使用&ndash;cluster fix的狀況發生</li></ol><h2 id=測試數據是否正確結果-有些數據key-name被修改了>測試數據，是否正確，結果->有些數據Key Name被修改了</h2><p>來查查看數據，是不是跟之前使用重啟Redis服務恢復數據時，得到的一樣</p><p>以下是使用重啟Redis服務恢復數據時，查到的key和value</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis01 redis<span class=o>]</span><span class=c1># redis-cli --user 帳號 --pass 密碼 -c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key剛好就在redis01主機上，所以執行直接顯示type</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:362C74F290B63E5F751DCF1E49EC34BEAF6822F0
</span></span><span class=line><span class=cl><span class=nb>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key在redis02主機上，會Redirected到此key所在slot主機上，再顯示type</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> DRM01001000347201
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>5914<span class=o>]</span> located at 192.168.1.12:6379
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key在redis03主機上，會Redirected到此key所在slot主機上，再顯示type</span>
</span></span><span class=line><span class=cl>192.168.1.12:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:EBB87CF1F764E6BACCC709323FE1457065B0CC8E
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>10759<span class=o>]</span> located at 192.168.1.13:6379
</span></span><span class=line><span class=cl><span class=nb>set</span>
</span></span><span class=line><span class=cl>192.168.1.13:6379&gt; SMEMBERS spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:EBB87CF1F764E6BACCC709323FE1457065B0CC8E
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;\xac\xed\x00\x05t\x00</span><span class=nv>$aef3b17d</span><span class=s2>-ed6f-4c4e-9cc3-ef69eda6f33c&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key在redis04主機上，會Redirected到此key所在slot主機上，再顯示type</span>
</span></span><span class=line><span class=cl>192.168.1.13:6379&gt; <span class=nb>type</span> TON01001010231201
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>12921<span class=o>]</span> located at 192.168.1.14:6379
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>192.168.1.14:6379&gt; hgetall TON01001010231201
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;path&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;/reader/book_content_unpack/teb/2022/10/17/TON01001010231201/TON01001010231201&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;iv&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;06ac4696c8a4bb94ecb7e82b38a1dc3f&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;key&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;36971e857d647324cb59e1cdf58d7071&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key在redis05主機上，會Redirected到此key所在slot主機上，再顯示type</span>
</span></span><span class=line><span class=cl>192.168.1.14:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:25E30A2AB63FE661B9AE7803EAD9A9AC234097FC
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>16326<span class=o>]</span> located at 192.168.1.18:6379
</span></span><span class=line><span class=cl><span class=nb>set</span>
</span></span><span class=line><span class=cl>192.168.1.18:6379&gt; SMEMBERS spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:25E30A2AB63FE661B9AE7803EAD9A9AC234097FC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;\xac\xed\x00\x05t\x00</span><span class=nv>$f0d82ce3</span><span class=s2>-28e3-493c-b992-439565cf987e&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看key type，此key在redis02主機上，會Redirected到此key所在slot主機上，再顯示type</span>
</span></span><span class=line><span class=cl>192.168.1.18:6379&gt; <span class=nb>type</span> BOOK_CASE_LIST_U_39048951
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>5895<span class=o>]</span> located at 192.168.1.12:6379
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>192.168.1.12:6379&gt; hgetall BOOK_CASE_LIST_U_39048951
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;0_5&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;{\&#34;result\&#34;:\&#34;00\&#34;,\&#34;syncTime\&#34;:\&#34;20231202164546\&#34;,\&#34;ebooks\&#34;:[{\&#34;deliverId\&#34;:\&#34;SON03001000560201\&#34;,\&#34;contentId\&#34;:\&#34;SON03001000560\&#34;,\&#34;title\&#34;:\&#34;\xe6\x8a\x95\xe8\xb3\x875\xe5\xb9\xb4\xef\xbc\x8c\xe6\x9c\xac\xe9\x87\x91\xe5\xbe\x9e4\xe8\x90\xac\xe5\x88\xb01\xe5\x84\x84\xe7\x9a\x84\xe5\xa5\xb3\xe4\xba\xba\xef\xbc\x9a\xe5\xbe\x9e\xe7\x9c\x81\xe9\x8c\xa2\xe3\x80\x81\xe5\xae\x9a\xe5\xad\x98\xe5\x88\xb0\xe8\x82\xa1\xe7\xa5\xa8\xef\xbc\x8c\xe5\xb0\x88\xe5\xb1\xac\xe5\xb0\x8f\xe8\xb3\x87\xe5\xa5\xb3\xe7\x9a\x84\xe8\xb3\xaa\xe6\x84\x9f\xe7\x90\x86\xe8\xb2\xa1\xe6\x8f\x90\xe6\xa1\x88\&#34;,\&#34;publisher\&#34;:\&#34;\xe5\xb4\xa7\xe7\x87\x81\xe6\x96\x87\xe5\x8c\x96\&#34;,\&#34;author\&#34;:\&#34;\xe6\xb7\x98\xe6\xb7\x98\&#34;,\&#34;bodyTypeCode\&#34;:\&#34;201\&#34;,\&#34;ebookType\&#34;:\&#34;\xe6\x9b\xb8\xe7\xb1\x8d\&#34;,\&#34;categories\&#34;:[\&#34;\xe9\x87\x91\xe8\x9e\x8d\xe7\x90\x86\xe8\xb2\xa1\&#34;],
</span></span></span></code></pre></div><p><font color=red>注意：可以看到，有些數據找不到了</font></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>root@redis91 redis<span class=o>]</span><span class=c1># redis-cli --user 帳號 --pass 密碼 -c</span>
</span></span><span class=line><span class=cl>Warning: Using a password with <span class=s1>&#39;-a&#39;</span> or <span class=s1>&#39;-u&#39;</span> option on the <span class=nb>command</span> line interface may not be safe.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 此數據找不到了</span>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:362C74F290B63E5F751DCF1E49EC34BEAF6822F0
</span></span><span class=line><span class=cl>none
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>127.0.0.1:6379&gt; <span class=nb>type</span> DRM01001000347201
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>5914<span class=o>]</span> located at 192.168.1.92:6379
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 此數據找不到了</span>
</span></span><span class=line><span class=cl>192.168.1.92:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:EBB87CF1F764E6BACCC709323FE1457065B0CC8E
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>10759<span class=o>]</span> located at 192.168.1.94:6379
</span></span><span class=line><span class=cl>none
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>192.168.1.94:6379&gt; <span class=nb>type</span> TON01001010231201
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>192.168.1.94:6379&gt; hgetall TON01001010231201
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;path&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;/reader/book_content_unpack/teb/2022/10/17/TON01001010231201/TON01001010231201&#34;</span>
</span></span><span class=line><span class=cl>3<span class=o>)</span> <span class=s2>&#34;key&#34;</span>
</span></span><span class=line><span class=cl>4<span class=o>)</span> <span class=s2>&#34;36971e857d647324cb59e1cdf58d7071&#34;</span>
</span></span><span class=line><span class=cl>5<span class=o>)</span> <span class=s2>&#34;iv&#34;</span>
</span></span><span class=line><span class=cl>6<span class=o>)</span> <span class=s2>&#34;06ac4696c8a4bb94ecb7e82b38a1dc3f&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 此數據找不到了</span>
</span></span><span class=line><span class=cl>192.168.1.94:6379&gt; <span class=nb>type</span> spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:25E30A2AB63FE661B9AE7803EAD9A9AC234097FC
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>16326<span class=o>]</span> located at 192.168.1.98:6379
</span></span><span class=line><span class=cl>none
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>192.168.1.98:6379&gt; <span class=nb>type</span> BOOK_CASE_LIST_U_39048951
</span></span><span class=line><span class=cl>-&gt; Redirected to slot <span class=o>[</span>5895<span class=o>]</span> located at 192.168.1.92:6379
</span></span><span class=line><span class=cl><span class=nb>hash</span>
</span></span><span class=line><span class=cl>192.168.1.92:6379&gt; hgetall BOOK_CASE_LIST_U_39048951
</span></span><span class=line><span class=cl>1<span class=o>)</span> <span class=s2>&#34;0_5&#34;</span>
</span></span><span class=line><span class=cl>2<span class=o>)</span> <span class=s2>&#34;{\&#34;result\&#34;:\&#34;00\&#34;,\&#34;syncTime\&#34;:\&#34;20231202164546\&#34;,\&#34;ebooks\&#34;:[{\&#34;deliverId\&#34;:\&#34;SON03001000560201\&#34;,\&#34;contentId\&#34;:\&#34;SON03001000560\&#34;,\&#34;title\&#34;:\&#34;\xe6\x8a\x95\xe8\xb3\x875\xe5\xb9\xb4\xef\xbc\x8c\xe6\x9c\xac\xe9\x87\x91\xe5\xbe\x9e4\xe8\x90\xac\xe5\x88\xb01\xe5\x84\x84\xe7\x9a\x84\xe5\xa5\xb3\xe4\xba\xba\xef\xbc\x9a\xe5\xbe\x9e\xe7\x9c\x81\xe9\x8c\xa2\xe3\x80\x81\xe5\xae\x9a\xe5\xad\x98\xe5\x88\xb0\xe8\x82\xa1\xe7\xa5\xa8\xef\xbc\x8c\xe5\xb0\x88\xe5\xb1\xac\xe5\xb0\x8f\xe8\xb3\x87\xe5\xa5\xb3\xe7\x9a\x84\xe8\xb3\xaa\xe6\x84\x9f\xe7\x90\x86\xe8\xb2\xa1\xe6\x8f\x90\xe6\xa1\x88\&#34;,\&#34;publisher\&#34;:\&#34;\xe5\xb4\xa7\xe7\x87\x81\xe6\x96\x87\xe5\x8c\x96\&#34;,\&#34;author\&#34;:\&#34;\xe6\xb7\x98\xe6\xb7\x98\&#34;,\&#34;bodyTypeCode\&#34;:\&#34;201\&#34;,\&#34;ebookType\&#34;:\&#34;\xe6\x9b\xb8\xe7\xb1\x8d\&#34;,\&#34;categories\&#34;:[\&#34;\xe9
</span></span></span></code></pre></div><p><font color=red>可以看到，數據樣式變了，此恢復數據方式會有問題，不可用</font></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 原數據</span>
</span></span><span class=line><span class=cl>spring:session:index:org.springframework.session.FindByIndexNameSessionRepository.PRINCIPAL_NAME_INDEX_NAME:362C74F290B63E5F751DCF1E49EC34BEAF6822F0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 用RedisInsight BULK ACTIONS恢復後的數據樣式變這樣</span>
</span></span><span class=line><span class=cl><span class=se>\x</span>19spring:session:index:org.s<span class=sb>`</span><span class=se>\x</span>18<span class=se>\t</span>framework.<span class=se>\x</span>a0!<span class=se>\x</span>01.F <span class=se>\&#34;\x</span>02ByI@<span class=err>&#39;</span><span class=se>\x</span>00N <span class=se>\x</span>1b<span class=se>\x</span>00S<span class=se>\x</span>808<span class=se>\x</span>1eRepository.PRINCIPAL_NAME_INDEX<span class=sb>`</span><span class=se>\n\x</span>1f:8E09B7E74AAA48FF8481847092A40E8<span class=se>\b</span>A0FBB829A
</span></span></code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/redis/>redis</a>
<a href=/tags/redisinsight/>redisinsight</a>
<a href=/tags/redis-cluster/>redis-cluster</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相關文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/2023/kubernetes-redisinsight/><div class=article-details><h2 class=article-title>使用Kubernetes架設RedisInsight 1.x版，管理Redis集群</h2></div></a></article><article><a href=/2023/redis-cluster-database-transfer-with-redis-shake/><div class=article-details><h2 class=article-title>使用Redis-Shake，還原數據，從一個cluster遷移所有分片數據到另一個cluster，結果->可行，恢復數據非常快</h2></div></a></article><article><a href=/2023/redis-cluster-database-transfer/><div class=article-details><h2 class=article-title>Redis Cluster 資料移轉，從一個cluster遷移所有分片數據到另一個cluster</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//blog-goldfishbrain-fighting-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2022 -
2023 翻轉吧金魚腦</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 建立<br>主題 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.20.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 設計</section><section class=totalcount>發表了103篇文章 ·
總計48.41k字</section><section class=running-time>本站已運行
<span id=runningdays class=running-days></span></section><section class=visit-count><span id=busuanzi_container_site_pv style=display:none>本站總訪問量 <span id=busuanzi_value_site_pv></span> 次 </span>·
<span id=busuanzi_container_site_uv style=display:none>總訪客數 <span id=busuanzi_value_site_uv></span> 人</span></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><a href=# id=back-to-top title=返回顶部></a><style>#back-to-top{display:none;position:fixed;bottom:20px;right:55px;width:55px;height:55px;border-radius:7px;background-color:rgba(64,158,255,.5);box-shadow:var(--shadow-l2);font-size:30px;text-align:center;line-height:50px;cursor:pointer}#back-to-top:before{content:' ';display:inline-block;position:relative;top:0;transform:rotate(135deg);height:10px;width:10px;border-width:0 0 2px 2px;border-color:var(--back-to-top-color);border-style:solid}#back-to-top:hover:before{border-color:#2674e0}@media screen and (max-width:768px){#back-to-top{bottom:20px;right:20px;width:40px;height:40px;font-size:10px}}@media screen and (min-width:1024px){#back-to-top{bottom:20px;right:40px}}@media screen and (min-width:1280px){#back-to-top{bottom:20px;right:55px}}@media screen and (min-width:1536px){#back-to-top{visibility:hidden}}</style><script>function backToTop(){document.documentElement.scrollIntoView({behavior:"smooth"})}window.onload=function(){let t=this.document.documentElement.scrollTop||this.document.body.scrollTop,e=this.document.getElementById("back-to-top");t>0?e.style.display="inline":e.style.display="none"},window.onscroll=function(){let t=this.document.documentElement.scrollTop||this.document.body.scrollTop,e=this.document.getElementById("back-to-top");t<200?e.style.display="none":(e.style.display="inline",e.addEventListener("click",backToTop,!1))}</script><script>(function(){var t,e=window;if(e.ChannelIO)return e.console.error("ChannelIO script included twice.");t=function(){t.c(arguments)},t.q=[],t.c=function(e){t.q.push(e)},e.ChannelIO=t;function n(){if(e.ChannelIOInitialized)return;e.ChannelIOInitialized=!0;var n,t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.channel.io/plugin/ch-plugin-web.js",n=document.getElementsByTagName("script")[0],n.parentNode&&n.parentNode.insertBefore(t,n)}document.readyState==="complete"?n():(e.addEventListener("DOMContentLoaded",n),e.addEventListener("load",n))})(),ChannelIO("boot",{pluginKey:"ad479103-2d28-421a-a916-ae09e72ce014"})</script><script>let s1="2023-10-7";s1=new Date(s1.replace(/-/g,"/"));let s2=new Date,timeDifference=s2.getTime()-s1.getTime(),days=Math.floor(timeDifference/(1e3*60*60*24)),hours=Math.floor(timeDifference%(1e3*60*60*24)/(1e3*60*60)),minutes=Math.floor(timeDifference%(1e3*60*60)/(1e3*60)),result=days+"天"+hours+"小時"+minutes+"分鐘";document.getElementById("runningdays").innerHTML=result</script></body></html>